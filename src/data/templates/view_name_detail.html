{% extends "view_page_detail.html" %}
{% load my_tags %}

{% block content %} 

   <script type="text/javascript">
     $(function(){

            $('#tabs').tabs();
      });
   </script>

<div class="content" id="IndividualDetail">

   {% filter breadcrumb %}
      {% format "/browse|Browse,/person|People,/person/%s|Person [%s],/person/%s/name/%s|Name #%s" object.handle object.gramps_id object.handle order order %}
   {% endfilter %}


<h3>{{person|make_name:user}} [{{person.gramps_id}}]</h3>
<div id="summaryarea">
<table class="infolist"> {% comment %} 4 cols {% endcomment %}
<tbody>

{% if user.is_authenticated %}
  {% ifequal action "edit" %}
    {% for error in form.errors %}
       {{error}}<br>
    {% endfor %}
  {% endifequal %}
{% endif %}
<form method="post">{% csrf_token %}
<tr>
 <td class="ColumnAttribute">{{form.surname.label}}:</td>
 <td class="ColumnValue" id="data">{% render form.surname user action %}</td>
 <td class="ColumnAttribute">{{form.prefix.label}}:</td>
 <td class="ColumnValue" id="data">{% render form.prefix user action %}</td>
</tr>
<tr>
 <td class="ColumnAttribute">{{form.first_name.label}}:</td>
 <td class="ColumnValue" id="data">{% render form.first_name user action %}</td>
 <td class="ColumnAttribute">{{form.call.label}}:</td>
 <td class="ColumnValue" id="data">{% render form.call user action %}</td>
<tr>
</tr>
 <td class="ColumnAttribute">{{form.title.label}}:</td>
 <td class="ColumnValue" id="data">{% render form.title user action %}</td>
 <td class="ColumnAttribute">{{form.suffix.label}}:</td>
 <td class="ColumnValue" id="data">{% render form.suffix user action %}</td>
<tr>
 <td class="ColumnAttribute">{{form.name_type.label}}:</td>
 <td class="ColumnValue" id="data">{% render form.name_type user action %}</td>
</tr>
<tr>
 <td class="ColumnAttribute">{{form.preferred.label}}:</td>
{% if form.model.preferred %}
 <td class="ColumnValue" id="data">True</td>
{% else %}
 <td class="ColumnValue" id="data">{% render form.preferred user action %}</td>
{% endif %}
 <td class="ColumnAttribute">{{form.private.label}}:</td>
 <td class="ColumnValue" id="data">{% render form.private user action %}</td>
</tr>
</tbody>
</table>
</div>
</div>

<!-- Tabs -->

<div class="ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">
  <ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
    <li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#tab-general">General</a></li>
    <li class="ui-corner-top ui-state-default"><a href="#tab-surnames">Surnames</a></li>
    <li class="ui-corner-top ui-state-default"><a href="#tab-names">Other Names</a></li>
    <li class="ui-corner-top ui-state-default"><a href="#tab-sources">Sources</a></li>
    <li class="ui-corner-top ui-state-default"><a href="#tab-notes">Notes</a></li>
  </ul>

  <div class="ui-tabs-panel ui-widget-content ui-corner-bottom"
  id="tab-general"> 
    <div style="overflow: auto; height:150px;">
    <table border="1">
    <tr><td style="background-color: #FFF2C5;">{{form.group_as.label}}: </td>
        <td>{% render form.group_as user action %}</td>
    </tr>
    <tr><td style="background-color: #FFF2C5;">{{form.sort_as.label}}: </td>
        <td>{% render form.sort_as user action %}</td>
    </tr>
    <tr><td style="background-color: #FFF2C5;">{{form.display_as.label}}: </td>
         <td>{% render form.display_as user action %}</td>
    </tr>
    <tr><td style="background-color: #FFF2C5;">{{form.text.label}}: </td>
         <td>{% render form.text user action %}</td>
    </tr>
    </table>
    </div>
    &nbsp;
  </div>
  <div class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide" id="tab-surnames">
    {% surname_table person user action "/person/%s/name/%s/surname" person.handle form.model.order %}
  </div>
  <div class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide" id="tab-names">
    {% name_table person user action "/person/%s/name" person.handle %}
  </div>
  <div class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide" id="tab-sources">
    {% source_table form.model user action "/person/%s/name/%s/source" person.handle form.model.order %}
  </div>
  <div class="ui-tabs-panel ui-widget-content ui-corner-bottom
	      ui-tabs-hide" id="tab-notes">
    {% note_table form.model user action "/person/%s/name/%s/note" person.handle form.model.order %}
  </div>
</div>

<input type="button" 
       value="Back to Person"
       onclick="document.location.href='/person/{{person.handle}}'"/>
{% if user.is_authenticated %}
  {% ifequal action "edit" %}
    <input type="hidden" name="action" value="save"/>
    <input type="submit" value="Save"/>
  {% else %}
    <input type="button" 
	   value="Edit Name"
	   onclick="document.location.href='/person/{{person.handle}}/name/{{order}}/edit'"/>
    <input type="button" 
	   value="Add Name"
	   onclick="document.location.href='/person/{{person.handle}}/name/add'"/>
    <input type="button" 
	   value="Delete Name"
	   onclick="document.location.href='/person/{{person.handle}}/name/{{order}}/delete'"/>
  {% endifequal %}
{% else %}
{% endif %}
</form>
{% endblock %}

